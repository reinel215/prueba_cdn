"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classPrivateFieldGet(receiver,privateMap){var descriptor=privateMap.get(receiver);if(!descriptor)throw new TypeError("attempted to get private field on non-instance");return descriptor.get?descriptor.get.call(receiver):descriptor.value}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}function sendMesagge(){windowPro.postMessage("este es mi evento desde el padre","*"),console.log("evento enviado")}var _validateCurrency=new WeakSet,_validateAmount=new WeakSet,_eventListener=new WeakMap,_payDispatchHandler=new WeakSet,_paymentSuccessfully=new WeakSet,_paymentFailed=new WeakSet,_sendKeys=new WeakSet,Pagos=function(){function Pagos(API_KEY,API_SECRET){var _this=this;_classCallCheck(this,Pagos),_sendKeys.add(this),_paymentFailed.add(this),_paymentSuccessfully.add(this),_payDispatchHandler.add(this),_validateAmount.add(this),_validateCurrency.add(this),_eventListener.set(this,{writable:!0,value:function value(event){console.log(event),_classPrivateMethodGet(_this,_payDispatchHandler,_payDispatchHandler2).call(_this,event.data)}}),this.API_KEY=API_KEY,this.API_SECRET=API_SECRET,this.paySucces=null,this.payFailed=null,this.window=null,Pagos.baseURL="http://localhost:3000/"}return _createClass(Pagos,[{key:"configure",value:function configure(_ref){var paySucces=_ref.paySucces,payFailed=_ref.payFailed;this.paySucces=paySucces,this.payFailed=payFailed}},{key:"pay",value:function pay(currency,amount){_classPrivateMethodGet(this,_validateCurrency,_validateCurrency2).call(this,currency),_classPrivateMethodGet(this,_validateAmount,_validateAmount2).call(this,amount);var url="".concat(Pagos.baseURL,"payment?amount=").concat(amount,"&currency=").concat(currency);this.window=window.open(url,"_blank","width=700,height=500,left=200,top=100"),window.addEventListener("message",_classPrivateFieldGet(this,_eventListener),!1)}}]),Pagos}(),_validateCurrency2=function _validateCurrency2(currency){if("USD"!==currency&&"VEF"!==currency&&"BTC"!==currency&&"PTR"!==currency&&"CNY"!==currency&&"JPY"!==currency)throw console.error("los tipos aceptados por la plataforma son: USD VEF BTC PTR CNY JPY"),new Error("el tipo de moneda:".concat(currency," no se encuentra entre los aceptados por la plataforma"))},_validateAmount2=function _validateAmount2(amount){var amountNumber=Number(amount);if(isNaN(amountNumber))throw new Error("el valor ".concat(amount," no se pudo convertir a number."))},_payDispatchHandler2=function _payDispatchHandler2(event){switch(event.type){case"child-tab-ready":_classPrivateMethodGet(this,_sendKeys,_sendKeys2).call(this);break;case"pay-success":_classPrivateMethodGet(this,_paymentSuccessfully,_paymentSuccessfully2).call(this,event.payload);break;case"pay-failed":_classPrivateMethodGet(this,_paymentFailed,_paymentFailed2).call(this,event.reason)}},_paymentSuccessfully2=function _paymentSuccessfully2(payload){if(window.removeEventListener("message",_classPrivateFieldGet(this,_eventListener),!1),!this.paySucces)throw new Error("pay success function miss for configuration");try{this.paySucces(payload)}catch(error){throw error}},_paymentFailed2=function _paymentFailed2(reason){if(window.removeEventListener("message",_classPrivateFieldGet(this,_eventListener)),!this.payFailed)throw new Error("pay failed function miss for configuration");try{this.payFailed(reason)}catch(error){throw error}},_sendKeys2=function _sendKeys2(){this.window.postMessage({APIKey:this.API_KEY,APISecrect:this.API_SECRET,type:"keys"},"*")};